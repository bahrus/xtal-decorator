(function(){var DASH_TO_CAMEL=/-[a-z]/g;function dashToCamelCase(dash){return dash.replace(DASH_TO_CAMEL,function(m){return m[1].toUpperCase()})}function getChildren(parent){switch(parent.nodeName){case"IFRAME":return this.$0.contentWindow.document.body.childNodes;default:var publicChildren=parent.childNodes,returnObj=[];if(parent.shadowRoot){parent.shadowRoot.childNodes.forEach(function(node){returnObj.push(node)})}parent.childNodes.forEach(function(node){returnObj.push(node)});return returnObj;}}function getChildFromSinglePath(el,token){var idx=0,nonIndexedToken=token;if(".."===token){return el.parentNode}if(token.endsWith("]")){var posOfOpen=token.indexOf("["),indxString=token.substring(posOfOpen+1,token.length-1);idx=parseInt(indxString);nonIndexedToken=token.substring(0,posOfOpen)}var matchingNodes=[];getChildren(el).forEach(function(child){if(child.matches&&child.matches(nonIndexedToken)){matchingNodes.push(child)}});return matchingNodes[idx]}var spKey="__xtal_deco_onPropsChange",XtalDeco=function(_HTMLElement){babelHelpers.inherits(XtalDeco,_HTMLElement);function XtalDeco(){babelHelpers.classCallCheck(this,XtalDeco);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(XtalDeco).apply(this,arguments))}babelHelpers.createClass(XtalDeco,[{key:"connectedCallback",value:function connectedCallback(){this.style.display="none";this.getElement("_nextSibling",function(t){return t.nextElementSibling});this.getElement("_script",function(t){return t.querySelector("script")})}},{key:"attachBehavior",value:function attachBehavior(evalObj,target){for(var topKey in evalObj){var subObj=evalObj[topKey];switch(topKey){case"on":for(var key in subObj){var handlerKey=key+"_decoHandler",prop=Object.defineProperty(target,handlerKey,{enumerable:!1,configurable:!0,writable:!0,value:subObj[key]});target.addEventListener(key,target[handlerKey])}break;case"props":var _loop=function _loop(_key){var propVal=subObj[_key];Object.defineProperty(target,_key,{get:function get(){return this["_"+_key]},set:function set(val){this["_"+_key]=val;var eventName=_key+"-changed",newEvent=new CustomEvent(eventName,{detail:{value:val},bubbles:!0,composed:!1});this.dispatchEvent(newEvent);if(this[spKey])this[spKey](_key,val)},enumerable:!0,configurable:!0});target[_key]=propVal};for(var _key in subObj){_loop(_key)}break;case"setters":for(var _key2 in subObj){var propVal=subObj[_key2];target[_key2]=propVal}break;default:switch(babelHelpers.typeof(subObj)){case"function":var fnKey="onPropsChange"===topKey?spKey:topKey,_prop=Object.defineProperty(target,fnKey,{enumerable:!1,configurable:!0,writable:!0,value:subObj});break;case"object":target[topKey]=subObj;break;}}}}},{key:"getElement",value:function getElement(fieldName,getter){var _this=this;this[fieldName]=getter(this);if(!this[fieldName]){setTimeout(function(){_this.getElement(fieldName,getter)});return}this.onDecoPropsChange()}},{key:"evaluateCode",value:function evaluateCode(scriptElement,target){var evalObj=eval(scriptElement.innerHTML);this.attachBehavior(evalObj,target);this._nextSibling.removeAttribute("disabled")}},{key:"onDecoPropsChange",value:function onDecoPropsChange(){if(!this._nextSibling||!this._script)return;this.evaluateCode(this._script,this._nextSibling)}}],[{key:"is",get:function get(){return"xtal-deco"}}]);return XtalDeco}(babelHelpers.wrapNativeSuper(HTMLElement));define(XtalDeco);function define(custEl){var tagName=custEl.is;if(customElements.get(tagName)){console.warn("Already registered "+tagName);return}customElements.define(tagName,custEl)}var disabled="disabled";function XtallatX(superClass){return function(_superClass){babelHelpers.inherits(_class,_superClass);function _class(){var _this2;babelHelpers.classCallCheck(this,_class);_this2=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(_class).apply(this,arguments));_this2._evCount={};return _this2}babelHelpers.createClass(_class,[{key:"attr",value:function attr(name,val,trueVal){var v=val?"set":"remove";this[v+"Attribute"](name,trueVal||val)}},{key:"to$",value:function to$(n){var mod=n%2;return(n-mod)/2+"-"+mod}},{key:"incAttr",value:function incAttr(name){var ec=this._evCount;if(name in ec){ec[name]++}else{ec[name]=0}this.attr("data-"+name,this.to$(ec[name]))}},{key:"attributeChangedCallback",value:function attributeChangedCallback(name,oldVal,newVal){switch(name){case disabled:this._disabled=null!==newVal;break;}}},{key:"de",value:function de(name,detail,asIs){var eventName=name+(asIs?"":"-changed"),newEvent=new CustomEvent(eventName,{detail:detail,bubbles:!0,composed:!1});this.dispatchEvent(newEvent);this.incAttr(eventName);return newEvent}},{key:"_upgradeProperties",value:function _upgradeProperties(props){var _this3=this;props.forEach(function(prop){if(_this3.hasOwnProperty(prop)){var value=_this3[prop];delete _this3[prop];_this3[prop]=value}})}},{key:"disabled",get:function get(){return this._disabled},set:function set(val){this.attr(disabled,val,"")}}],[{key:"observedAttributes",get:function get(){return[disabled]}}]);return _class}(superClass)}function observeCssSelector(superClass){var eventNames=["animationstart","MSAnimationStart","webkitAnimationStart"];return function(_superClass2){babelHelpers.inherits(_class2,_superClass2);function _class2(){babelHelpers.classCallCheck(this,_class2);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(_class2).apply(this,arguments))}babelHelpers.createClass(_class2,[{key:"addCSSListener",value:function addCSSListener(id,targetSelector,insertListener){var _this4=this;if(this._boundInsertListener)return;var styleInner="\n            @keyframes ".concat(id," {\n                from {\n                    opacity: 0.99;\n                }\n                to {\n                    opacity: 1;\n                }\n            }\n    \n            ").concat(targetSelector,"{\n                animation-duration: 0.001s;\n                animation-name: ").concat(id,";\n            }\n            "),style=document.createElement("style");style.innerHTML=styleInner;var host=getHost(this);if(null!==host){host.shadowRoot.appendChild(style)}else{document.body.appendChild(style)}this._boundInsertListener=insertListener.bind(this);var container=host?host.shadowRoot:document;eventNames.forEach(function(name){container.addEventListener(name,_this4._boundInsertListener,!1)})}},{key:"disconnectedCallback",value:function disconnectedCallback(){var _this5=this;if(this._boundInsertListener){var host=getHost(this),container=host?host.shadowRoot:document;eventNames.forEach(function(name){container.removeEventListener(name,_this5._boundInsertListener)})}if(babelHelpers.get(babelHelpers.getPrototypeOf(_class2.prototype),"disconnectedCallback",this)!==void 0)babelHelpers.get(babelHelpers.getPrototypeOf(_class2.prototype),"disconnectedCallback",this).call(this)}}]);return _class2}(superClass)}function qsa(css,from){return[].slice.call((from?from:this).querySelectorAll(css))}var into_next_element="into-next-element",import_template="import-template",attach_script="attach-script",XtalDecor=function(_XtallatX){babelHelpers.inherits(XtalDecor,_XtallatX);function XtalDecor(){babelHelpers.classCallCheck(this,XtalDecor);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(XtalDecor).apply(this,arguments))}babelHelpers.createClass(XtalDecor,[{key:"attributeChangedCallback",value:function attributeChangedCallback(name,oldVal,newVal){babelHelpers.get(babelHelpers.getPrototypeOf(XtalDecor.prototype),"attributeChangedCallback",this).call(this,name,oldVal,newVal);switch(name){case import_template:this._importTemplate=null!==newVal;break;case attach_script:this._attachScript=null!==newVal;break;case into_next_element:this._intoNextElement=null!==newVal;break;}this.onDecoPropsChange()}},{key:"connectedCallback",value:function connectedCallback(){this._upgradeProperties(["disabled","attachScript","importTemplate","intoNextElement","whereCSSMatches"]);this._connected=!0;this.onDecoPropsChange();this.addMutationObserver()}},{key:"disconnectedCallback",value:function disconnectedCallback(){if(this._mutationObserver)this._mutationObserver.disconnect()}},{key:"do",value:function _do(){this.appendTemplates();this.attachScripts()}},{key:"addMutationObserver",value:function addMutationObserver(){var _this6=this;this._mutationObserver=new MutationObserver(function(mutationsList){_this6.getTemplatesAndScripts();_this6.do()});this.getTemplatesAndScripts();this.do();this._mutationObserver.observe(this,{childList:!0})}},{key:"getTemplatesAndScripts",value:function getTemplatesAndScripts(){this._templates=qsa("template",this);this._scripts=qsa("script",this)}},{key:"onDecoPropsChange",value:function onDecoPropsChange(){if(!this._connected||this.disabled)return;if(this._intoNextElement&&!this._nextSibling){this.getElement("_nextSibling",function(t){return t.nextElementSibling});return}this.do()}},{key:"appendTemplates",value:function appendTemplates(target){var _this7=this;if(!this._templates)return;if(!target&&this._intoNextElement)target=this._nextSibling;if(this._importTemplate&&target){customElements.whenDefined(target.tagName.toLowerCase()).then(function(){_this7._templates.forEach(function(template){if(template.dataset.xtalTemplInserted)return;var subTarget=target,path=template.dataset.path;if(path){subTarget=cd(target,path)}var clone=document.importNode(template.content,!0);subTarget.shadowRoot.appendChild(clone);template.dataset.xtalTemplInserted="true"})})}}},{key:"doScripts",value:function doScripts(target){var _this8=this;this._scripts.forEach(function(script){if(script.dataset.xtalScriptAttached)return;var subTarget=target,path=script.dataset.path;if(path){subTarget=cd(target,path)}_this8.evaluateCode(script,subTarget)})}},{key:"attachScripts",value:function attachScripts(target){var _this9=this;if(!this._scripts)return;if(!target&&this._intoNextElement)target=this._nextSibling;if(this._attachScript&&target){var ln=target.localName;if(-1<ln.indexOf("-")){customElements.whenDefined(target.tagName.toLowerCase()).then(function(){_this9.doScripts(target)})}else{this.doScripts(target)}}}},{key:"intoNextElement",get:function get(){return this._intoNextElement},set:function set(val){this.attr(into_next_element,val,"")}},{key:"importTemplate",get:function get(){return this._importTemplate},set:function set(val){this.attr(import_template,val,"")}},{key:"attachScript",get:function get(){return this._attachScript},set:function set(val){this.attr(attach_script,val,"")}}],[{key:"is",get:function get(){return"xtal-decor"}},{key:"observedAttributes",get:function get(){return babelHelpers.get(babelHelpers.getPrototypeOf(XtalDecor),"observedAttributes",this).concat([into_next_element,import_template,attach_script])}}]);return XtalDecor}(XtallatX(XtalDeco));XtalDecor._addedNodeInsertionStyle=!1;define(XtalDecor);var where_target_selector="where-target-selector",XtalDecorator=function(_observeCssSelector){babelHelpers.inherits(XtalDecorator,_observeCssSelector);function XtalDecorator(){babelHelpers.classCallCheck(this,XtalDecorator);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(XtalDecorator).apply(this,arguments))}babelHelpers.createClass(XtalDecorator,[{key:"insertListener",value:function insertListener(e){var _this10=this;if(e.animationName===this.id){var target=e.target;setTimeout(function(){_this10.appendTemplates(target);_this10.attachScripts(target)},0)}}},{key:"attributeChangedCallback",value:function attributeChangedCallback(name,oldVal,newVal){switch(name){case where_target_selector:this._whereTargetSelector=newVal;break;}babelHelpers.get(babelHelpers.getPrototypeOf(XtalDecorator.prototype),"attributeChangedCallback",this).call(this,name,oldVal,newVal)}},{key:"connectedCallback",value:function connectedCallback(){this._upgradeProperties(["whereTargetSelector"]);babelHelpers.get(babelHelpers.getPrototypeOf(XtalDecorator.prototype),"connectedCallback",this).call(this)}},{key:"onDecoPropsChange",value:function onDecoPropsChange(){if(!this._whereTargetSelector){babelHelpers.get(babelHelpers.getPrototypeOf(XtalDecorator.prototype),"onDecoPropsChange",this).call(this);return}if(!this.id){console.error("xtal-decorator requires an id");return}this.addCSSListener(this.id,this._whereTargetSelector,this.insertListener)}},{key:"whereTargetSelector",get:function get(){return this._whereTargetSelector},set:function set(val){if(this._whereTargetSelector&&this._whereTargetSelector!==val)throw"Only supports one value";this.attr(where_target_selector,val)}}],[{key:"is",get:function get(){return"xtal-decorator"}},{key:"observedAttributes",get:function get(){return babelHelpers.get(babelHelpers.getPrototypeOf(XtalDecorator),"observedAttributes",this).concat([where_target_selector])}}]);return XtalDecorator}(observeCssSelector(XtalDecor));define(XtalDecorator)})();